<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.269">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>DL2022 – quarto-input4f814eaf</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script>
<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="../styles.css">
</head>

<body class="nav-sidebar docked nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">DL2022</span>
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link active" href="../about.html" aria-current="page">
 <span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/guebin/DL2022/tree/main/posts"><i class="bi bi-github" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://www.youtube.com/channel/UCQk9RyBNgXc7ORIsYlOfQrg/playlists?view=50&amp;sort=dd&amp;shelf_id=3"><i class="bi bi-youtube" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
</ul>
              <div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title"></h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation docked overflow-auto">
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../about.html" class="sidebar-item-text sidebar-link">About</a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">Posts</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../posts/2021-11-18-(11주차) 11월18일-23일.html" class="sidebar-item-text sidebar-link">(11주차) 11월18일, 11월23일</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../posts/2021-11-30-(12주차) 11월30일.html" class="sidebar-item-text sidebar-link active">(12주차) 11월30일</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../posts/2022-11-29-13wk-2-final.html" class="sidebar-item-text sidebar-link">final</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../posts/2022-09-01-1wk-1.html" class="sidebar-item-text sidebar-link">Introduction</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../posts/2022-10-28-9wk-1-midsol.html" class="sidebar-item-text sidebar-link">mid</a>
  </div>
</li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="false">Appendix</a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="false">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../posts/Appendix/2022-12-07-A1.html" class="sidebar-item-text sidebar-link">A1: 깊은복사와 얕은복사</a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="false">I. Overview</a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="false">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../posts/I. Overview/2022-09-06-1wk-2.html" class="sidebar-item-text sidebar-link">01wk-2: Overview (1)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../posts/I. Overview/2022-09-08-2wk-1.html" class="sidebar-item-text sidebar-link">02wk-1: Overview (2)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../posts/I. Overview/2022-09-13-2wk-2.html" class="sidebar-item-text sidebar-link">02wk-1: Overview (3)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../posts/I. Overview/2022-09-15-3wk-1.html" class="sidebar-item-text sidebar-link">02wk-1: Overview (4)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../posts/I. Overview/2022-09-19-Assignment1.html" class="sidebar-item-text sidebar-link">Assignment 1</a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="false">II. DNN</a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="false">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../posts/II. DNN/2022-09-20-3wk-2.html" class="sidebar-item-text sidebar-link">03wk-2: 딥러닝의 기초 (1)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../posts/II. DNN/2022-09-22-4wk-1.html" class="sidebar-item-text sidebar-link">04wk-1: 딥러닝의 기초 (2)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../posts/II. DNN/2022-09-27-4wk-2.html" class="sidebar-item-text sidebar-link">04wk-2: 딥러닝의 기초 (3)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../posts/II. DNN/2022-09-29-5wk-1.html" class="sidebar-item-text sidebar-link">05wk-1: 딥러닝의 기초 (4)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../posts/II. DNN/2022-10-04-5wk-2.html" class="sidebar-item-text sidebar-link">05wk-2: 딥러닝의 기초 (5)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../posts/II. DNN/2022-10-06-6wk-1.html" class="sidebar-item-text sidebar-link">06wk-1: 딥러닝의 기초 (6)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../posts/II. DNN/2022-10-11-6wk-2.html" class="sidebar-item-text sidebar-link">06wk-2: 딥러닝의 기초 (7)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../posts/II. DNN/2022-10-13-7wk-1.html" class="sidebar-item-text sidebar-link">07wk-1: 딥러닝의 기초 (8)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../posts/II. DNN/2022-10-26-Assignment2.html" class="sidebar-item-text sidebar-link">Assignment 2</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../posts/II. DNN/2022-12-13-Extra-1.html" class="sidebar-item-text sidebar-link">Extra-1: 딥러닝의 기초 (9)</a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="false">III. CNN</a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="false">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../posts/III. CNN/2022-10-18-7wk-2.html" class="sidebar-item-text sidebar-link">07wk-2: 이미지분석 (1)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../posts/III. CNN/2022-10-20-8wk-1.html" class="sidebar-item-text sidebar-link">08wk-1: 이미지분석 (2)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../posts/III. CNN/2022-10-25-8wk-2.html" class="sidebar-item-text sidebar-link">08wk-2: 이미지분석 (3)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../posts/III. CNN/2022-10-26-Assignment3.html" class="sidebar-item-text sidebar-link">Assignment 3</a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="false">IV. RNN</a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="false">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../posts/IV. RNN/2022-11-01-9wk-2.html" class="sidebar-item-text sidebar-link">09wk-2: 순환신경망 (1)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../posts/IV. RNN/2022-11-03-10wk-1.html" class="sidebar-item-text sidebar-link">10wk-1: 순환신경망 (2)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../posts/IV. RNN/2022-11-08-10wk-2.html" class="sidebar-item-text sidebar-link">10wk-2: 순환신경망 (3)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../posts/IV. RNN/2022-11-10-11wk-1.html" class="sidebar-item-text sidebar-link">11wk-1: 순환신경망 (4)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../posts/IV. RNN/2022-11-15-11wk-2.html" class="sidebar-item-text sidebar-link">11wk-2: 순환신경망 (5)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../posts/IV. RNN/2022-11-17-12wk-1.html" class="sidebar-item-text sidebar-link">12wk-1: 순환신경망 (6)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../posts/IV. RNN/2022-11-22-12wk-2.html" class="sidebar-item-text sidebar-link">12wk-2: 순환신경망 (7)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../posts/IV. RNN/2022-12-01-14wk-1.html" class="sidebar-item-text sidebar-link">14wk-1: 순환신경망 (8)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../posts/IV. RNN/2022-12-01-14wk-2.html" class="sidebar-item-text sidebar-link">14wk-2: 순환신경망 (9)</a>
  </div>
</li>
      </ul>
  </li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#주차-11월30일" id="toc-주차-11월30일" class="nav-link active" data-scroll-target="#주차-11월30일">(12주차) 11월30일</a>
  <ul class="collapse">
  <li><a href="#강의영상" id="toc-강의영상" class="nav-link" data-scroll-target="#강의영상">강의영상</a></li>
  <li><a href="#기울기소멸" id="toc-기울기소멸" class="nav-link" data-scroll-target="#기울기소멸">기울기소멸</a>
  <ul class="collapse">
  <li><a href="#고요속의-외침" id="toc-고요속의-외침" class="nav-link" data-scroll-target="#고요속의-외침">고요속의 외침</a></li>
  <li><a href="#정의" id="toc-정의" class="nav-link" data-scroll-target="#정의">정의</a></li>
  <li><a href="#이해" id="toc-이해" class="nav-link" data-scroll-target="#이해">이해</a></li>
  <li><a href="#해결책-기울기-소멸에-대한-해결책" id="toc-해결책-기울기-소멸에-대한-해결책" class="nav-link" data-scroll-target="#해결책-기울기-소멸에-대한-해결책">해결책 (기울기 소멸에 대한 해결책)</a></li>
  </ul></li>
  <li><a href="#추천시스템" id="toc-추천시스템" class="nav-link" data-scroll-target="#추천시스템">추천시스템</a>
  <ul class="collapse">
  <li><a href="#import" id="toc-import" class="nav-link" data-scroll-target="#import">import</a></li>
  <li><a href="#data-시뮬레이션" id="toc-data-시뮬레이션" class="nav-link" data-scroll-target="#data-시뮬레이션">Data (시뮬레이션)</a></li>
  <li><a href="#user-item-matrix" id="toc-user-item-matrix" class="nav-link" data-scroll-target="#user-item-matrix">user-item matrix</a></li>
  <li><a href="#예측" id="toc-예측" class="nav-link" data-scroll-target="#예측">예측?</a></li>
  <li><a href="#fastai를-학습-df-to-dls" id="toc-fastai를-학습-df-to-dls" class="nav-link" data-scroll-target="#fastai를-학습-df-to-dls">fastai를 학습: df <span class="math inline">\(\to\)</span> dls</a></li>
  <li><a href="#fastai를-통한-학습-learn" id="toc-fastai를-통한-학습-learn" class="nav-link" data-scroll-target="#fastai를-통한-학습-learn">fastai를 통한 학습: learn</a></li>
  <li><a href="#추천-마지막유저에-대한-예측결과-아마-홍차를-좋아할듯" id="toc-추천-마지막유저에-대한-예측결과-아마-홍차를-좋아할듯" class="nav-link" data-scroll-target="#추천-마지막유저에-대한-예측결과-아마-홍차를-좋아할듯">추천: 마지막유저에 대한 예측결과 (아마 홍차를 좋아할듯)</a></li>
  <li><a href="#숙제" id="toc-숙제" class="nav-link" data-scroll-target="#숙제">숙제</a></li>
  </ul></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">



<section id="주차-11월30일" class="level1">
<h1>(12주차) 11월30일</h1>
<blockquote class="blockquote">
<p>기울기소멸, 추천시스템</p>
</blockquote>
<ul>
<li>toc:true</li>
<li>branch: master</li>
<li>badges: true</li>
<li>comments: true</li>
<li>author: 최규빈</li>
</ul>
<section id="강의영상" class="level2">
<h2 class="anchored" data-anchor-id="강의영상">강의영상</h2>
<blockquote class="blockquote">
<p>youtube: https://youtube.com/playlist?list=PLQqh36zP38-xfh29sgAIrEQkDqXR-vR3f</p>
</blockquote>
<p><code>-</code> (1/3) 기울기소멸</p>
<p><code>-</code> (2/3) 추천시스템</p>
<p><code>-</code> (3/3) 숙제설명</p>
</section>
<section id="기울기소멸" class="level2">
<h2 class="anchored" data-anchor-id="기울기소멸">기울기소멸</h2>
<section id="고요속의-외침" class="level3">
<h3 class="anchored" data-anchor-id="고요속의-외침">고요속의 외침</h3>
<p><code>-</code> https://www.youtube.com/watch?v=ouitOnaDtFY</p>
<p><code>-</code> 중간에 한명이라도 잘못 말한다면..</p>
</section>
<section id="정의" class="level3">
<h3 class="anchored" data-anchor-id="정의">정의</h3>
<p><code>-</code> In machine learning, the vanishing gradient problem is encountered when training artificial neural networks with gradient-based learning methods and backpropagation.</p>
</section>
<section id="이해" class="level3">
<h3 class="anchored" data-anchor-id="이해">이해</h3>
<p><code>-</code> 당연한것 아닌가? - 그레디언트 기반의 학습 (그레디언트 기반의 옵티마이저): 손실함수의 기울기를 통하여 업데이트 하는 방식 - 역전파: 손실함수의 기울기를 구하는 테크닉 (체인룰 + <span class="math inline">\(\alpha\)</span>). 구체적으로는 (1) 손실함수를 여러단계로 쪼개고 (2) 각 단계의 미분값을 각각 구하고 (3) 그것들을 모두 곱하여 기울기를 계산한다. - 0 근처의 숫자를 계속 곱하면 터지거나 0으로 간다. (사실 안정적인 기울기가 나올 것이라고 생각하는것 자체가 사실 이상함)</p>
<div class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1"></a><span class="im">import</span> numpy <span class="im">as</span> np </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1"></a>grads <span class="op">=</span> np.random.uniform(low<span class="op">=-</span><span class="dv">2</span>,high<span class="op">=</span><span class="dv">2</span>,size<span class="op">=</span><span class="dv">100</span>) </span>
<span id="cb2-2"><a href="#cb2-2"></a>grads</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="2">
<pre><code>array([-0.04807346, -1.29968172,  0.60383275, -1.11097504, -1.44903838,
       -1.81770819, -0.82995838, -0.30307517, -1.62486386,  1.14841271,
        0.05317044, -1.63595745, -1.27254039, -0.2793212 ,  1.4193291 ,
       -1.87957006, -1.50413435, -1.6143583 , -1.97979251, -0.1319077 ,
       -0.36277507,  0.24188449,  0.8205258 , -1.15353317, -0.94630341,
        0.60335535, -1.4326661 ,  1.27171997,  1.51390194, -0.3285052 ,
       -1.56389259, -1.55964141,  0.29636461, -0.74477874, -1.6119124 ,
        0.01097634, -0.25255016,  1.80684873,  0.90766818, -0.25062987,
       -0.74179267, -0.50494702,  1.89992546, -0.2911778 ,  0.3116119 ,
        1.63679034,  0.86030588, -1.10851323, -1.13171181, -1.58949804,
        0.82233945, -1.81269013, -0.31257892,  1.00176613, -0.49897359,
       -1.05885742,  0.49664799, -1.02531506, -0.81051658, -1.34188376,
       -1.98882591,  0.32634551,  1.39557143, -1.13150272, -1.5616825 ,
       -0.0478864 , -1.34446087, -0.56475749, -1.90177931, -0.38516623,
        0.75889489, -1.86710065, -1.85428312,  1.82248239,  1.04363342,
        1.08128997, -0.36466711, -1.99204485,  0.81840524, -1.11993576,
       -0.53666968, -0.09132125,  1.57303259,  1.82113986,  0.31948837,
        0.34639304, -1.68151764,  1.0845407 , -0.01560537,  0.73393873,
        0.85033511,  1.98350062, -0.45107395,  1.45704639,  1.48581033,
       -1.57196761,  0.92182647,  0.78667051, -1.01047196, -0.13306075])</code></pre>
</div>
</div>
<div class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1"></a>grads.prod()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="3">
<pre><code>-3.5832605040779705e-14</code></pre>
</div>
</div>
<ul>
<li>기울기가 소멸함</li>
</ul>
<div class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1"></a>grads <span class="op">=</span> np.random.uniform(low<span class="op">=-</span><span class="dv">5</span>,high<span class="op">=</span><span class="dv">5</span>,size<span class="op">=</span><span class="dv">100</span>) </span>
<span id="cb6-2"><a href="#cb6-2"></a>grads.prod()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="4">
<pre><code>2.2118230498890502e+26</code></pre>
</div>
</div>
<ul>
<li>기울기가 폭발함.</li>
</ul>
<div class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1"></a>grads <span class="op">=</span> np.random.uniform(low<span class="op">=-</span><span class="dv">1</span>,high<span class="op">=</span><span class="fl">3.5</span>,size<span class="op">=</span><span class="dv">100</span>) </span>
<span id="cb8-2"><a href="#cb8-2"></a>grads.prod()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="5">
<pre><code>5.058085058858178e-07</code></pre>
</div>
</div>
<p><code>-</code> 도깨비: 기울기가 소멸하기도 하고 터지기도 한다.</p>
</section>
<section id="해결책-기울기-소멸에-대한-해결책" class="level3">
<h3 class="anchored" data-anchor-id="해결책-기울기-소멸에-대한-해결책">해결책 (기울기 소멸에 대한 해결책)</h3>
<blockquote class="blockquote">
<p>Note: 잘 정리되어있는것이 없어서 제 머리속에서 정리했습니다. 부정확할수도 있어요</p>
</blockquote>
<p><code>-</code> 개념 - 데이터 <span class="math inline">\(\to\)</span> (아키텍처,손실함수,역전파,업데이트)</p>
<p><code>-</code> Multi-level hierarchy - 여러층을 쪼개서 학습하자 <span class="math inline">\(\to\)</span> 어떻게? 사전학습, 층벼학습 - 기울기소실문제를 해결하여 딥러닝을 유행시킨 태초의(?) 방법임. - 결국 입력자료를 바꾼뒤에 학습하는 형태</p>
<p><code>-</code> Faster hardware - GPU를 중심으로 한 테크닉 - 근본적인 문제해결책은 아니라는 힌튼의 비판 - CPU를 쓸때보다 GPU를 쓰면 약간 더 깊은 모형을 학습할 수 있다 정도?</p>
<p><code>-</code> Residual networks - 훌륭한 접근법중 하나임 - 아키텍처를 변경하는 방법이지만, 사실상 손실함수를 부드럽게 만드는 기법으로 이해해도 된다. - 솟컷이라는 아키텍처를 추가하여 이리저리 실험해보니까 손실함수가 부드러워졌다. &lt;— 이런게 아니고 - 손실함수를 부드럽게 하기 위해서는 층별의차이(residual)를 학습하는게 유리할 것 같다. 그런데 이것을 위한 효과를 주기 위해서는 단지 아키텍처에 숏만만 추가하면 되겠다. &lt;— 이런 모티브였을 것이다.</p>
<p><code>-</code> Other activation functions - 렐루의 개발</p>
<p><code>-</code> 배치정규화 - 어쩌다보니 되는것. - 배치정규화는 원래 공변량 쉬프트를 잡기 위한 방법임. 그런데 기울기 소멸에도 효과가 있음. 현재는 기울기소멸문제에 대한 해결책으로 빠짐없이 언급되고 있음. 2015년의 원래 논문에는 기울기소멸에 대한 언급은 없었음. (https://arxiv.org/pdf/1502.03167.pdf) - 심지어 배치정규화는 오버피팅을 잡는효과도 있음 (이것은 논문에 언급했음)</p>
<p><code>-</code> <strong>기울기를 안구하면 안되나?</strong>` - 베이지안 최적화기법: (https://arxiv.org/pdf/1807.02811.pdf) <span class="math inline">\(\to\)</span> GPU를 어떻게 쓰지? <span class="math inline">\(\to\)</span> 느리다</p>
</section>
</section>
<section id="추천시스템" class="level2">
<h2 class="anchored" data-anchor-id="추천시스템">추천시스템</h2>
<section id="import" class="level3">
<h3 class="anchored" data-anchor-id="import">import</h3>
<div class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd </span>
<span id="cb10-2"><a href="#cb10-2"></a><span class="im">import</span> torch </span>
<span id="cb10-3"><a href="#cb10-3"></a><span class="im">from</span> fastai.collab <span class="im">import</span> <span class="op">*</span> </span>
<span id="cb10-4"><a href="#cb10-4"></a><span class="im">from</span> fastai.tabular.<span class="bu">all</span> <span class="im">import</span> <span class="op">*</span> </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="data-시뮬레이션" class="level3">
<h3 class="anchored" data-anchor-id="data-시뮬레이션">Data (시뮬레이션)</h3>
<div class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1"></a>df<span class="op">=</span>pd.read_csv(<span class="st">'https://raw.githubusercontent.com/guebin/2021BDA/master/_notebooks/2021-11-30-recommend.csv'</span>)</span>
<span id="cb11-2"><a href="#cb11-2"></a>df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="7">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>user</th>
      <th>item</th>
      <th>rating</th>
      <th>item_name</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>15</td>
      <td>1.084308</td>
      <td>홍차5</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>1</td>
      <td>4.149209</td>
      <td>커피1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1</td>
      <td>11</td>
      <td>1.142659</td>
      <td>홍차1</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1</td>
      <td>5</td>
      <td>4.033415</td>
      <td>커피5</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1</td>
      <td>4</td>
      <td>4.078139</td>
      <td>커피4</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>995</th>
      <td>100</td>
      <td>18</td>
      <td>4.104276</td>
      <td>홍차8</td>
    </tr>
    <tr>
      <th>996</th>
      <td>100</td>
      <td>17</td>
      <td>4.164773</td>
      <td>홍차7</td>
    </tr>
    <tr>
      <th>997</th>
      <td>100</td>
      <td>14</td>
      <td>4.026915</td>
      <td>홍차4</td>
    </tr>
    <tr>
      <th>998</th>
      <td>100</td>
      <td>4</td>
      <td>0.838720</td>
      <td>커피4</td>
    </tr>
    <tr>
      <th>999</th>
      <td>100</td>
      <td>7</td>
      <td>1.094826</td>
      <td>커피7</td>
    </tr>
  </tbody>
</table>
<p>1000 rows × 4 columns</p>
</div>
</div>
</div>
</section>
<section id="user-item-matrix" class="level3">
<h3 class="anchored" data-anchor-id="user-item-matrix">user-item matrix</h3>
<p><code>-</code> 아래와 같은 매트릭스를 고려하자.</p>
<div class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1"></a>df2 <span class="op">=</span> pd.DataFrame([[<span class="va">None</span>]<span class="op">*</span><span class="dv">20</span>]<span class="op">*</span><span class="dv">100</span>,columns<span class="op">=</span>[<span class="st">'커피'</span><span class="op">+</span><span class="bu">str</span>(i) <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>,<span class="dv">11</span>)]<span class="op">+</span>[<span class="st">'홍차'</span><span class="op">+</span><span class="bu">str</span>(i) <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>,<span class="dv">11</span>)]) </span>
<span id="cb12-2"><a href="#cb12-2"></a>df2.index <span class="op">=</span> pd.Index([<span class="st">'user'</span><span class="op">+</span><span class="bu">str</span>(i) <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>,<span class="dv">101</span>)])</span>
<span id="cb12-3"><a href="#cb12-3"></a>df2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="8">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>커피1</th>
      <th>커피2</th>
      <th>커피3</th>
      <th>커피4</th>
      <th>커피5</th>
      <th>커피6</th>
      <th>커피7</th>
      <th>커피8</th>
      <th>커피9</th>
      <th>커피10</th>
      <th>홍차1</th>
      <th>홍차2</th>
      <th>홍차3</th>
      <th>홍차4</th>
      <th>홍차5</th>
      <th>홍차6</th>
      <th>홍차7</th>
      <th>홍차8</th>
      <th>홍차9</th>
      <th>홍차10</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>user1</th>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
    </tr>
    <tr>
      <th>user2</th>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
    </tr>
    <tr>
      <th>user3</th>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
    </tr>
    <tr>
      <th>user4</th>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
    </tr>
    <tr>
      <th>user5</th>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>user96</th>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
    </tr>
    <tr>
      <th>user97</th>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
    </tr>
    <tr>
      <th>user98</th>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
    </tr>
    <tr>
      <th>user99</th>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
    </tr>
    <tr>
      <th>user100</th>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
    </tr>
  </tbody>
</table>
<p>100 rows × 20 columns</p>
</div>
</div>
</div>
<div class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1"></a><span class="cf">for</span> (i,j) <span class="kw">in</span> <span class="bu">zip</span>(df.user.to_list(), df.item.to_list()):</span>
<span id="cb13-2"><a href="#cb13-2"></a>    df2.iloc[i<span class="op">-</span><span class="dv">1</span>,j<span class="op">-</span><span class="dv">1</span>]<span class="op">=</span>df.query(<span class="st">'user == @i and item == @j'</span>)[<span class="st">'rating'</span>].to_list()[<span class="dv">0</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1"></a>df2.iloc[:<span class="dv">5</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="10">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>커피1</th>
      <th>커피2</th>
      <th>커피3</th>
      <th>커피4</th>
      <th>커피5</th>
      <th>커피6</th>
      <th>커피7</th>
      <th>커피8</th>
      <th>커피9</th>
      <th>커피10</th>
      <th>홍차1</th>
      <th>홍차2</th>
      <th>홍차3</th>
      <th>홍차4</th>
      <th>홍차5</th>
      <th>홍차6</th>
      <th>홍차7</th>
      <th>홍차8</th>
      <th>홍차9</th>
      <th>홍차10</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>user1</th>
      <td>4.149209</td>
      <td>None</td>
      <td>None</td>
      <td>4.078139</td>
      <td>4.033415</td>
      <td>4.071871</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>1.142659</td>
      <td>1.109452</td>
      <td>None</td>
      <td>0.603118</td>
      <td>1.084308</td>
      <td>None</td>
      <td>0.906524</td>
      <td>None</td>
      <td>None</td>
      <td>0.903826</td>
    </tr>
    <tr>
      <th>user2</th>
      <td>4.031811</td>
      <td>None</td>
      <td>None</td>
      <td>3.822704</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>4.07141</td>
      <td>3.996206</td>
      <td>None</td>
      <td>None</td>
      <td>0.839565</td>
      <td>1.011315</td>
      <td>None</td>
      <td>1.120552</td>
      <td>0.91134</td>
      <td>None</td>
      <td>0.860954</td>
      <td>0.871482</td>
      <td>None</td>
    </tr>
    <tr>
      <th>user3</th>
      <td>4.082178</td>
      <td>4.196436</td>
      <td>None</td>
      <td>3.956876</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>4.450931</td>
      <td>3.97209</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>0.983838</td>
      <td>None</td>
      <td>0.918576</td>
      <td>1.206796</td>
      <td>0.913116</td>
      <td>None</td>
      <td>0.956194</td>
    </tr>
    <tr>
      <th>user4</th>
      <td>None</td>
      <td>4.000621</td>
      <td>3.89557</td>
      <td>None</td>
      <td>3.838781</td>
      <td>3.967183</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>4.105741</td>
      <td>1.147554</td>
      <td>None</td>
      <td>1.34686</td>
      <td>None</td>
      <td>0.614099</td>
      <td>1.297301</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>1.147545</td>
    </tr>
    <tr>
      <th>user5</th>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>3.888208</td>
      <td>None</td>
      <td>3.97033</td>
      <td>3.97949</td>
      <td>None</td>
      <td>4.010982</td>
      <td>None</td>
      <td>0.920995</td>
      <td>1.081111</td>
      <td>0.999345</td>
      <td>None</td>
      <td>1.195183</td>
      <td>None</td>
      <td>0.818332</td>
      <td>1.236331</td>
      <td>None</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<ul>
<li>user1~user5는 대체로 커피를 선호한다.</li>
<li>user1은 커피 2,3,7,8,9,10을 먹지는 않았는데, 아마 먹었다면 높은 점수를 주었을 것임.</li>
</ul>
<div class="cell" data-execution_count="11">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1"></a>df2.iloc[<span class="dv">47</span>:<span class="dv">53</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="11">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>커피1</th>
      <th>커피2</th>
      <th>커피3</th>
      <th>커피4</th>
      <th>커피5</th>
      <th>커피6</th>
      <th>커피7</th>
      <th>커피8</th>
      <th>커피9</th>
      <th>커피10</th>
      <th>홍차1</th>
      <th>홍차2</th>
      <th>홍차3</th>
      <th>홍차4</th>
      <th>홍차5</th>
      <th>홍차6</th>
      <th>홍차7</th>
      <th>홍차8</th>
      <th>홍차9</th>
      <th>홍차10</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>user48</th>
      <td>None</td>
      <td>None</td>
      <td>3.718709</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>4.484278</td>
      <td>4.242403</td>
      <td>None</td>
      <td>3.654447</td>
      <td>0.981285</td>
      <td>1.089422</td>
      <td>0.945297</td>
      <td>None</td>
      <td>1.367151</td>
      <td>0.984146</td>
      <td>None</td>
      <td>0.779323</td>
      <td>None</td>
      <td>None</td>
    </tr>
    <tr>
      <th>user49</th>
      <td>4.012018</td>
      <td>4.347253</td>
      <td>3.752401</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>4.182699</td>
      <td>3.763614</td>
      <td>4.112049</td>
      <td>None</td>
      <td>None</td>
      <td>0.921155</td>
      <td>0.947049</td>
      <td>0.937485</td>
      <td>None</td>
      <td>None</td>
      <td>1.046802</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
    </tr>
    <tr>
      <th>user50</th>
      <td>4.208589</td>
      <td>None</td>
      <td>3.995654</td>
      <td>3.85952</td>
      <td>4.186735</td>
      <td>None</td>
      <td>None</td>
      <td>3.955416</td>
      <td>4.017231</td>
      <td>4.312376</td>
      <td>None</td>
      <td>None</td>
      <td>1.148465</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>1.2535</td>
      <td>None</td>
      <td>None</td>
      <td>0.985061</td>
    </tr>
    <tr>
      <th>user51</th>
      <td>None</td>
      <td>None</td>
      <td>1.158754</td>
      <td>None</td>
      <td>None</td>
      <td>0.961621</td>
      <td>0.958685</td>
      <td>0.986134</td>
      <td>1.207339</td>
      <td>0.799213</td>
      <td>None</td>
      <td>4.053459</td>
      <td>None</td>
      <td>None</td>
      <td>4.214456</td>
      <td>3.94822</td>
      <td>None</td>
      <td>4.168223</td>
      <td>None</td>
      <td>None</td>
    </tr>
    <tr>
      <th>user52</th>
      <td>0.794371</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>0.72175</td>
      <td>None</td>
      <td>0.99541</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>4.713239</td>
      <td>4.061688</td>
      <td>3.791844</td>
      <td>4.008471</td>
      <td>3.96703</td>
      <td>4.420732</td>
      <td>4.055309</td>
      <td>None</td>
    </tr>
    <tr>
      <th>user53</th>
      <td>None</td>
      <td>0.586384</td>
      <td>1.170372</td>
      <td>0.939492</td>
      <td>None</td>
      <td>None</td>
      <td>1.299762</td>
      <td>None</td>
      <td>None</td>
      <td>0.818039</td>
      <td>4.155103</td>
      <td>4.131003</td>
      <td>None</td>
      <td>3.839847</td>
      <td>3.859583</td>
      <td>None</td>
      <td>None</td>
      <td>3.873978</td>
      <td>None</td>
      <td>None</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<ul>
<li>user1 <span class="math inline">\(\sim\)</span> user50은 커피를 선호하고 user51 <span class="math inline">\(\sim\)</span> user100은 홍차를 선호함</li>
</ul>
<div class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1"></a>df2.iloc[<span class="dv">94</span>:]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="12">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>커피1</th>
      <th>커피2</th>
      <th>커피3</th>
      <th>커피4</th>
      <th>커피5</th>
      <th>커피6</th>
      <th>커피7</th>
      <th>커피8</th>
      <th>커피9</th>
      <th>커피10</th>
      <th>홍차1</th>
      <th>홍차2</th>
      <th>홍차3</th>
      <th>홍차4</th>
      <th>홍차5</th>
      <th>홍차6</th>
      <th>홍차7</th>
      <th>홍차8</th>
      <th>홍차9</th>
      <th>홍차10</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>user95</th>
      <td>1.190142</td>
      <td>None</td>
      <td>0.818878</td>
      <td>None</td>
      <td>1.150194</td>
      <td>None</td>
      <td>None</td>
      <td>1.287971</td>
      <td>None</td>
      <td>0.586373</td>
      <td>None</td>
      <td>None</td>
      <td>4.06455</td>
      <td>4.399665</td>
      <td>None</td>
      <td>None</td>
      <td>3.573139</td>
      <td>3.944602</td>
      <td>None</td>
      <td>4.012274</td>
    </tr>
    <tr>
      <th>user96</th>
      <td>0.511905</td>
      <td>1.066144</td>
      <td>None</td>
      <td>1.31543</td>
      <td>None</td>
      <td>1.285778</td>
      <td>None</td>
      <td>0.6784</td>
      <td>1.02302</td>
      <td>0.886803</td>
      <td>None</td>
      <td>4.055996</td>
      <td>None</td>
      <td>None</td>
      <td>4.156489</td>
      <td>4.127622</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
    </tr>
    <tr>
      <th>user97</th>
      <td>None</td>
      <td>1.035022</td>
      <td>None</td>
      <td>1.085834</td>
      <td>None</td>
      <td>0.812558</td>
      <td>None</td>
      <td>1.074543</td>
      <td>None</td>
      <td>0.852806</td>
      <td>3.894772</td>
      <td>None</td>
      <td>4.071385</td>
      <td>3.935935</td>
      <td>None</td>
      <td>None</td>
      <td>3.989815</td>
      <td>None</td>
      <td>None</td>
      <td>4.267142</td>
    </tr>
    <tr>
      <th>user98</th>
      <td>None</td>
      <td>1.115511</td>
      <td>None</td>
      <td>1.101395</td>
      <td>0.878614</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>1.329319</td>
      <td>None</td>
      <td>4.12519</td>
      <td>None</td>
      <td>4.354638</td>
      <td>3.811209</td>
      <td>4.144648</td>
      <td>None</td>
      <td>None</td>
      <td>4.116915</td>
      <td>3.887823</td>
      <td>None</td>
    </tr>
    <tr>
      <th>user99</th>
      <td>None</td>
      <td>0.850794</td>
      <td>None</td>
      <td>None</td>
      <td>0.927884</td>
      <td>0.669895</td>
      <td>None</td>
      <td>None</td>
      <td>0.665429</td>
      <td>1.387329</td>
      <td>None</td>
      <td>None</td>
      <td>4.329404</td>
      <td>4.111706</td>
      <td>3.960197</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>3.725288</td>
      <td>4.122072</td>
    </tr>
    <tr>
      <th>user100</th>
      <td>None</td>
      <td>None</td>
      <td>1.413968</td>
      <td>0.83872</td>
      <td>None</td>
      <td>None</td>
      <td>1.094826</td>
      <td>0.987888</td>
      <td>None</td>
      <td>1.177387</td>
      <td>3.957383</td>
      <td>4.136731</td>
      <td>None</td>
      <td>4.026915</td>
      <td>None</td>
      <td>None</td>
      <td>4.164773</td>
      <td>4.104276</td>
      <td>None</td>
      <td>None</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
</section>
<section id="예측" class="level3">
<h3 class="anchored" data-anchor-id="예측">예측?</h3>
<p><code>-</code> None의 값을 추론하는 방법? 머리속으로는 알고있음. 그런데 어떻게 수식화 할지?</p>
<div class="cell" data-execution_count="13">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1"></a>df2.loc[<span class="st">'user1'</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="13">
<pre><code>커피1     4.149209
커피2         None
커피3         None
커피4     4.078139
커피5     4.033415
커피6     4.071871
커피7         None
커피8         None
커피9         None
커피10        None
홍차1     1.142659
홍차2     1.109452
홍차3         None
홍차4     0.603118
홍차5     1.084308
홍차6         None
홍차7     0.906524
홍차8         None
홍차9         None
홍차10    0.903826
Name: user1, dtype: object</code></pre>
</div>
</div>
<p><code>-</code> 유저의 취향은 예를들면 아래와 같이 표현할 수 있다. - user1의 취향 = (커피좋아함, 홍차싫어함) = (0.8, 0.21)</p>
<p><code>-</code> 코딩해보자.</p>
<div class="cell" data-execution_count="14">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1"></a>user1_prprnc <span class="op">=</span> (<span class="fl">0.8</span>,<span class="fl">0.21</span>) </span>
<span id="cb19-2"><a href="#cb19-2"></a>user1_prprnc</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="14">
<pre><code>(0.8, 0.21)</code></pre>
</div>
</div>
<p><code>-</code> 여기에서 (0.8,0.21)은 각각 (커피음료,홍차음료)와 같은 음료의 특징으로 해석가능. 현재는 단순하게 원소가 2인 벡터이지만 다양한 feature도 가능하다. - 음료의특징: (커피음료, 홍차음료, 우유포함, 설탕포함정도, 아이스여부, 행사여부)</p>
<p><code>-</code> 아이템4와 아이템11의 특징은 예를들면 아래와 같이 표현할 수 있다.</p>
<div class="cell" data-execution_count="15">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1"></a>item4_ftr <span class="op">=</span> (<span class="fl">0.71</span>, <span class="fl">0.03</span>) <span class="co"># 커피4 </span></span>
<span id="cb21-2"><a href="#cb21-2"></a>item11_ftr <span class="op">=</span> (<span class="fl">0.1</span>, <span class="fl">0.88</span>) <span class="co"># 홍차1  </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><code>-</code> 유저의 선호도와 아이템의 feature를 내적하여보자.</p>
<div class="cell" data-execution_count="16">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1"></a>np.array(user1_prprnc) <span class="op">@</span> np.array(item4_ftr) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="16">
<pre><code>0.5742999999999999</code></pre>
</div>
</div>
<div class="cell" data-execution_count="17">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1"></a>np.array(user1_prprnc) <span class="op">@</span> np.array(item11_ftr) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="17">
<pre><code>0.26480000000000004</code></pre>
</div>
</div>
<p><code>-</code> 유저의 선호도와 item의 feature가 비슷할수록 값이 높게 나온다. 실제로 user1이 커피4와 홍차1에 매긴 평점은 (4.078139,1.142659) 인데 (0.5743, 0.2648) 가 실제평점과 비슷하게 나오도록 하면 좋겠다.</p>
<p><code>-</code> 적당히 값을 조정하여 보자.</p>
<div class="cell" data-execution_count="18">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1"></a>user1_prprnc <span class="op">=</span> (<span class="fl">0.8</span>,<span class="fl">0.21</span>) </span>
<span id="cb26-2"><a href="#cb26-2"></a>item4_ftr <span class="op">=</span> (<span class="dv">5</span>, <span class="fl">0.03</span>) <span class="co"># 커피4 </span></span>
<span id="cb26-3"><a href="#cb26-3"></a>item11_ftr <span class="op">=</span> (<span class="fl">0.1</span>, <span class="fl">4.8</span>) <span class="co"># 홍차1</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="19">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1"></a>np.array(user1_prprnc) <span class="op">@</span> np.array(item4_ftr) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="19">
<pre><code>4.0063</code></pre>
</div>
</div>
<div class="cell" data-execution_count="20">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1"></a>np.array(user1_prprnc) <span class="op">@</span> np.array(item11_ftr) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="20">
<pre><code>1.088</code></pre>
</div>
</div>
<p><code>-</code> 신기한것은 이 파라메터들이 있다면 None에 대한 추론도 가능하다는 것이다. 예를들어서 user2는 홍차1을 먹지 않았지만 item11_ftr(홍차1)의 <code>계수값</code>이 다른유저를 통해 학습되었다면 user2가 홍차1을 먹고 내릴 평점이 예측가능하다.</p>
<div class="cell" data-execution_count="21">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1"></a>df2.loc[<span class="st">'user2'</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="21">
<pre><code>커피1     4.031811
커피2         None
커피3         None
커피4     3.822704
커피5         None
커피6         None
커피7         None
커피8      4.07141
커피9     3.996206
커피10        None
홍차1         None
홍차2     0.839565
홍차3     1.011315
홍차4         None
홍차5     1.120552
홍차6      0.91134
홍차7         None
홍차8     0.860954
홍차9     0.871482
홍차10        None
Name: user2, dtype: object</code></pre>
</div>
</div>
<div class="cell" data-execution_count="22">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1"></a>user2_prprnc <span class="op">=</span> (<span class="fl">0.77</span>,<span class="fl">0.18</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="23">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1"></a>np.array(user2_prprnc) <span class="op">@</span> np.array(item11_ftr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="23">
<pre><code>0.9410000000000001</code></pre>
</div>
</div>
<p><code>-</code> 생각해보니까 <code>user1_prprnc</code>, … , <code>user100_prprnc</code>, <code>item1_ftr</code>, … , <code>item20_ftr</code>를 <span class="math inline">\({\bf W}\)</span>라고 해석하면 우리가 <span class="math inline">\({\bf W}\)</span> 바꿈에 따라 예측값과 손실이 결정되므로 네트워크 구조가 만들어진다.</p>
<p><code>-</code> 정리하면 적당한 아래와 같은 매트릭스를 정의하여</p>
<ul>
<li><p><span class="math inline">\({\bf U} = \begin{bmatrix} \tt user1~ prprnc \\ \dots \\ \tt user100~prprnc \end{bmatrix}\)</span> <span class="math inline">\(\quad 100 \times 2\)</span> mat</p></li>
<li><p><span class="math inline">\({\bf V} = \begin{bmatrix} \tt item1~ ftr \\ \dots \\ \tt item20~ftr \end{bmatrix}\)</span> <span class="math inline">\(\quad 20 \times 2\)</span> mat</p></li>
</ul>
<p>${}{}^$ <code>df2</code> 가 만족하도록 하면 된다. (None은 무시)</p>
</section>
<section id="fastai를-학습-df-to-dls" class="level3">
<h3 class="anchored" data-anchor-id="fastai를-학습-df-to-dls">fastai를 학습: df <span class="math inline">\(\to\)</span> dls</h3>
<div class="cell" data-execution_count="30">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1"></a>dls<span class="op">=</span>CollabDataLoaders.from_df(df,bs<span class="op">=</span><span class="dv">100</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="32">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1"></a>dls.items</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="32">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>user</th>
      <th>item</th>
      <th>rating</th>
      <th>item_name</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>814</th>
      <td>82</td>
      <td>8</td>
      <td>0.927823</td>
      <td>커피8</td>
    </tr>
    <tr>
      <th>328</th>
      <td>33</td>
      <td>7</td>
      <td>4.175642</td>
      <td>커피7</td>
    </tr>
    <tr>
      <th>68</th>
      <td>7</td>
      <td>12</td>
      <td>0.995359</td>
      <td>홍차2</td>
    </tr>
    <tr>
      <th>205</th>
      <td>21</td>
      <td>3</td>
      <td>3.797043</td>
      <td>커피3</td>
    </tr>
    <tr>
      <th>509</th>
      <td>51</td>
      <td>6</td>
      <td>0.961621</td>
      <td>커피6</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>886</th>
      <td>89</td>
      <td>5</td>
      <td>1.064357</td>
      <td>커피5</td>
    </tr>
    <tr>
      <th>142</th>
      <td>15</td>
      <td>1</td>
      <td>4.245275</td>
      <td>커피1</td>
    </tr>
    <tr>
      <th>512</th>
      <td>52</td>
      <td>8</td>
      <td>0.995410</td>
      <td>커피8</td>
    </tr>
    <tr>
      <th>731</th>
      <td>74</td>
      <td>18</td>
      <td>4.053283</td>
      <td>홍차8</td>
    </tr>
    <tr>
      <th>318</th>
      <td>32</td>
      <td>9</td>
      <td>3.850437</td>
      <td>커피9</td>
    </tr>
  </tbody>
</table>
<p>800 rows × 4 columns</p>
</div>
</div>
</div>
</section>
<section id="fastai를-통한-학습-learn" class="level3">
<h3 class="anchored" data-anchor-id="fastai를-통한-학습-learn">fastai를 통한 학습: learn</h3>
<div class="cell" data-execution_count="142">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1"></a>lrnr <span class="op">=</span> collab_learner(dls,n_factors<span class="op">=</span><span class="dv">2</span>,y_range<span class="op">=</span>(<span class="dv">0</span>,<span class="dv">5</span>))</span>
<span id="cb38-2"><a href="#cb38-2"></a>lrnr.fit(<span class="dv">30</span>,<span class="fl">0.01</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th>epoch</th>
      <th>train_loss</th>
      <th>valid_loss</th>
      <th>time</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>2.332310</td>
      <td>2.324714</td>
      <td>00:00</td>
    </tr>
    <tr>
      <td>1</td>
      <td>2.301398</td>
      <td>2.314132</td>
      <td>00:00</td>
    </tr>
    <tr>
      <td>2</td>
      <td>2.255456</td>
      <td>2.235110</td>
      <td>00:00</td>
    </tr>
    <tr>
      <td>3</td>
      <td>2.180693</td>
      <td>2.062851</td>
      <td>00:00</td>
    </tr>
    <tr>
      <td>4</td>
      <td>2.068622</td>
      <td>1.799302</td>
      <td>00:00</td>
    </tr>
    <tr>
      <td>5</td>
      <td>1.918429</td>
      <td>1.467824</td>
      <td>00:00</td>
    </tr>
    <tr>
      <td>6</td>
      <td>1.734515</td>
      <td>1.099332</td>
      <td>00:00</td>
    </tr>
    <tr>
      <td>7</td>
      <td>1.529240</td>
      <td>0.753254</td>
      <td>00:00</td>
    </tr>
    <tr>
      <td>8</td>
      <td>1.318664</td>
      <td>0.473745</td>
      <td>00:00</td>
    </tr>
    <tr>
      <td>9</td>
      <td>1.118887</td>
      <td>0.281612</td>
      <td>00:00</td>
    </tr>
    <tr>
      <td>10</td>
      <td>0.941217</td>
      <td>0.170759</td>
      <td>00:00</td>
    </tr>
    <tr>
      <td>11</td>
      <td>0.790015</td>
      <td>0.113465</td>
      <td>00:00</td>
    </tr>
    <tr>
      <td>12</td>
      <td>0.664468</td>
      <td>0.087310</td>
      <td>00:00</td>
    </tr>
    <tr>
      <td>13</td>
      <td>0.561132</td>
      <td>0.076604</td>
      <td>00:00</td>
    </tr>
    <tr>
      <td>14</td>
      <td>0.476078</td>
      <td>0.072097</td>
      <td>00:00</td>
    </tr>
    <tr>
      <td>15</td>
      <td>0.405709</td>
      <td>0.069820</td>
      <td>00:00</td>
    </tr>
    <tr>
      <td>16</td>
      <td>0.347135</td>
      <td>0.068991</td>
      <td>00:00</td>
    </tr>
    <tr>
      <td>17</td>
      <td>0.298197</td>
      <td>0.068708</td>
      <td>00:00</td>
    </tr>
    <tr>
      <td>18</td>
      <td>0.257201</td>
      <td>0.068535</td>
      <td>00:00</td>
    </tr>
    <tr>
      <td>19</td>
      <td>0.222736</td>
      <td>0.068374</td>
      <td>00:00</td>
    </tr>
    <tr>
      <td>20</td>
      <td>0.193690</td>
      <td>0.067657</td>
      <td>00:00</td>
    </tr>
    <tr>
      <td>21</td>
      <td>0.169164</td>
      <td>0.066795</td>
      <td>00:00</td>
    </tr>
    <tr>
      <td>22</td>
      <td>0.148427</td>
      <td>0.065751</td>
      <td>00:00</td>
    </tr>
    <tr>
      <td>23</td>
      <td>0.130861</td>
      <td>0.064602</td>
      <td>00:00</td>
    </tr>
    <tr>
      <td>24</td>
      <td>0.115963</td>
      <td>0.064182</td>
      <td>00:00</td>
    </tr>
    <tr>
      <td>25</td>
      <td>0.103277</td>
      <td>0.063416</td>
      <td>00:00</td>
    </tr>
    <tr>
      <td>26</td>
      <td>0.092521</td>
      <td>0.062831</td>
      <td>00:00</td>
    </tr>
    <tr>
      <td>27</td>
      <td>0.083378</td>
      <td>0.062791</td>
      <td>00:00</td>
    </tr>
    <tr>
      <td>28</td>
      <td>0.075562</td>
      <td>0.062564</td>
      <td>00:00</td>
    </tr>
    <tr>
      <td>29</td>
      <td>0.068923</td>
      <td>0.061822</td>
      <td>00:00</td>
    </tr>
  </tbody>
</table>
</div>
</div>
<div class="cell" data-execution_count="143">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1"></a>lrnr.show_results()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>user</th>
      <th>item</th>
      <th>rating</th>
      <th>rating_pred</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>64.0</td>
      <td>4.0</td>
      <td>1.193997</td>
      <td>1.018805</td>
    </tr>
    <tr>
      <th>1</th>
      <td>65.0</td>
      <td>14.0</td>
      <td>3.956821</td>
      <td>3.988665</td>
    </tr>
    <tr>
      <th>2</th>
      <td>59.0</td>
      <td>2.0</td>
      <td>1.161738</td>
      <td>0.927356</td>
    </tr>
    <tr>
      <th>3</th>
      <td>36.0</td>
      <td>6.0</td>
      <td>4.028756</td>
      <td>4.073104</td>
    </tr>
    <tr>
      <th>4</th>
      <td>78.0</td>
      <td>10.0</td>
      <td>0.968873</td>
      <td>0.834417</td>
    </tr>
    <tr>
      <th>5</th>
      <td>1.0</td>
      <td>17.0</td>
      <td>0.906524</td>
      <td>0.973807</td>
    </tr>
    <tr>
      <th>6</th>
      <td>96.0</td>
      <td>6.0</td>
      <td>1.285778</td>
      <td>0.798828</td>
    </tr>
    <tr>
      <th>7</th>
      <td>91.0</td>
      <td>10.0</td>
      <td>1.453194</td>
      <td>1.013060</td>
    </tr>
    <tr>
      <th>8</th>
      <td>25.0</td>
      <td>10.0</td>
      <td>4.342545</td>
      <td>4.081783</td>
    </tr>
  </tbody>
</table>
</div>
</div>
<p><code>-</code> 학습이 잘 되었음.</p>
</section>
<section id="추천-마지막유저에-대한-예측결과-아마-홍차를-좋아할듯" class="level3">
<h3 class="anchored" data-anchor-id="추천-마지막유저에-대한-예측결과-아마-홍차를-좋아할듯">추천: 마지막유저에 대한 예측결과 (아마 홍차를 좋아할듯)</h3>
<div class="cell" data-execution_count="146">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb40-1"><a href="#cb40-1"></a>X,y <span class="op">=</span> dls.one_batch()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="147">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb41-1"><a href="#cb41-1"></a>X[:<span class="dv">5</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="147">
<pre><code>tensor([[94,  3],
        [46, 12],
        [61, 19],
        [47, 11],
        [87, 20]])</code></pre>
</div>
</div>
<div class="cell" data-execution_count="148">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb43-1"><a href="#cb43-1"></a>y[:<span class="dv">5</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="148">
<pre><code>tensor([[1.1616],
        [0.6749],
        [4.1603],
        [0.6241],
        [4.3710]])</code></pre>
</div>
</div>
<div class="cell" data-execution_count="153">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb45-1"><a href="#cb45-1"></a>torch.tensor([[<span class="dv">94</span>,<span class="dv">3</span>]])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="153">
<pre><code>tensor([[94,  3]])</code></pre>
</div>
</div>
<div class="cell" data-execution_count="154">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb47-1"><a href="#cb47-1"></a>lrnr.model(torch.tensor([[<span class="dv">94</span>,<span class="dv">3</span>]]).to(<span class="st">"cuda:0"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="154">
<pre><code>tensor([1.2002], device='cuda:0', grad_fn=&lt;AddBackward0&gt;)</code></pre>
</div>
</div>
<div class="cell" data-execution_count="157">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb49-1"><a href="#cb49-1"></a>x100 <span class="op">=</span> torch.tensor([[<span class="dv">100</span>,j] <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>,<span class="dv">21</span>) ])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="158">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb50-1"><a href="#cb50-1"></a>lrnr.model(x100.to(<span class="st">"cuda:0"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="158">
<pre><code>tensor([1.0416, 1.0414, 1.0742, 1.1004, 1.0125, 1.0141, 1.1448, 1.0488, 1.1155,
        1.0428, 3.9658, 4.0532, 4.0562, 3.9919, 4.0497, 4.0288, 3.9983, 4.0984,
        3.9943, 4.0803], device='cuda:0', grad_fn=&lt;AddBackward0&gt;)</code></pre>
</div>
</div>
<p><code>-</code> 예상대로 홍차를 매우 좋아함.</p>
</section>
<section id="숙제" class="level3">
<h3 class="anchored" data-anchor-id="숙제">숙제</h3>
<p>숙제는 유저2번에 대한 선호도 조사</p>


</section>
</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>